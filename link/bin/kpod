#!/bin/bash
# Author            : Hongbo Liu <hbliu@freewheel.tv>
# Date              : 2017-12-05
# Last Modified Date: 2017-12-05
# Last Modified By  : Hongbo Liu <hbliu@freewheel.tv>


usage() {
cat << EOF
Usage: $(basename $0)  pod_name_part namespace shell
EOF
exit 0
}

main() {
    local pod_name="${1:-aws-ads}"
    local namespace="${2:-ads}"
    local shell="${3:-bash}"

    local OPT OPTARG OPTIND
    while getopts 'h' OPT; do
        case $OPT in
            h) usage ;;
        esac
    done
    shift $(($OPTIND - 1))

    kubectl exec -n $namespace -it $(kubectl get pod -n $namespace -o name | grep -o "${pod_name}.*") $shell
}

main $@
